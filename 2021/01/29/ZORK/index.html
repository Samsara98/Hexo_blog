<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ZORK | SamsarA</title><script src="https://cdn.bootcss.com/valine/1.4.4/Valine.min.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/mermaid/8.8.2/mermaid.min.js"></script><script>mermaid.initialize({
  startOnLoad: true
  , theme: 'dark'
});</script><link rel="stylesheet" href="/wk1044481101.github.io/css/arknights.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/wk1044481101.github.io/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/wk1044481101.github.io/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/wk1044481101.github.io/atom.xml" title="SamsarA" type="application/atom+xml">
</head><body><header><nav><a href="/wk1044481101.github.io/">Home</a><a href="/wk1044481101.github.io/archives/">Archives</a></nav></header><main><article><div id="post-bg"><div id="post-title"><h1>ZORK</h1><hr></div><div id="post-content"><p>Welcome to <a target="_blank" rel="noopener" href="https://samsara98.gitee.io/samsara/">SamsarA’s Blog</a>! If you get any problems when reading my blog, you can<br>ask me on <a target="_blank" rel="noopener" href="https://gitee.com/samsara98/samsara">Gitee</a>.</p>
<h1 id="SamsarA’s-ZORK"><a href="#SamsarA’s-ZORK" class="headerlink" title="SamsarA’s ZORK"></a>SamsarA’s ZORK</h1><pre><code>#序列化  #SQLite  #OOP  #IO  </code></pre>
<p>&nbsp; You can get source code on my <a target="_blank" rel="noopener" href="https://gitee.com/samsara98/zork">Gitee</a>.</p>
<ul>
<li>游戏简化操作，用大写字母和数字1234操控，例如WSAD对应北南西东移动，其余操作见游戏内提示</li>
<li>游戏有一个存档位,下次进入游戏时选继续游戏即可</li>
<li>游戏保存了通关玩家的数据，可通过封神榜查看</li>
<li>在地图探索时可以走动、查看状态、查看地图、存档</li>
<li>在探索是搜索可以获取该地区的道具或者进行交互，时常探索一下吧</li>
<li>人物属性：等级，攻击力，生命值，经验值, 感染程度</li>
</ul>
<hr>
<h2 id="OOP"><a href="#OOP" class="headerlink" title="OOP"></a>OOP</h2><p><em>Composition Over Inheritance，组合高于对象</em>   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">组合：has-a的关系<br>需要某个功能，引用一个接口，实现该接口来实现功能，耦合度较低。通过实现不同的接口可组合出多种类，需要更换功能时无需改动主程序，<br>修改或更换接口的实现类即可。但是容易产生过多的类。如果类之间没有“is-a”的关系，可以通过实现接口与组合的方式来达到相同的目的。<br>设计模式中的策略模式可以很好的说明这一点，采用接口与组合的方式比采用继承的方式具有更好的可扩展性。  <br></code></pre></td></tr></table></figure>
<p>组合与继承都是有效地利用已有类的资源的重要方式。<br>但是二者的概念和使用场景皆不同</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">继承：is-a的关系   <br>继承需要实现父类的全部方法，容易产生冗余，只有当需要继承关系时才采用继承，并且要围绕继承设计。例如只有当需要子类向上转型为父类<br>时采用继承。过多的使用继承会破坏代码的可维护性，当父类被修改时，会影响到所有继承自它的子类，从而增加程序的维护难度和成本。<br></code></pre></td></tr></table></figure>
<hr>
<h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><p><em>游戏需要存档，即为保存游戏的状态，主要为游戏地点的姿态和角色状态，分别为对象List和对象，采用序列化方式保存数据</em><br><em>父类实现Serializable接口则子类无需实现即可序列化，若只有子类实现则序列化时父类的属性会丢失，只保留子类的属性</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">public class Character implements Serializable &#123;<br>    ...<br>    //用于反序列化,当反序列化目标版本与当前类不同时,可以兼容,不存在的属性置默认值<br>    private static final long serialVersionUID = 368751884395357044L; <br>    //子类序列化需要父类实现无参构造函数<br>    public <span class="hljs-function"><span class="hljs-title">Character</span></span>() &#123;&#125;    <br>    <br>    ...<br></code></pre></td></tr></table></figure>
<p><em>序列化及反序列化需要对象流，对象流建立在字节流上</em><br><em>InputStream和OutputStream为抽象类，FileInputStream/FileOutputStream 是InputStream/OutputStream子类</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">private void <span class="hljs-function"><span class="hljs-title">archive</span></span>() &#123;    //序列化，将对象序列化为文件<br><br>    ...<br>    <br>    try (FileOutputStream fos = new FileOutputStream(playerArchive);<br>         ObjectOutputStream oos = new ObjectOutputStream(fos);<br>         FileOutputStream fos2 = new FileOutputStream(placesArchive);<br>         ObjectOutputStream oos2 = new ObjectOutputStream(fos2)) &#123;<br>        <br>        oos.writeObject(player);<br>        oos2.writeObject(places);<br><br>    &#125; catch (IOException e) &#123;<br>        e.printStackTrace();<br>    &#125;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">private boolean <span class="hljs-function"><span class="hljs-title">readArchive</span></span>() &#123;   //反序列化从，序列化文件读入到对象<br>    <br>    ...<br>    //需要判断文件是否存在<br>    <span class="hljs-keyword">if</span> (!playArchive.exists() || !placesArchive.exists()) &#123;<br>        println(<span class="hljs-string">&quot;!存档不存在或者不完整!请检测&quot;</span> + PLAYER_ARCHIVE_FILE + <span class="hljs-string">&quot;以及&quot;</span> + PLACES_ARCHIVE_FILE);  <br>        <span class="hljs-built_in">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    try (FileInputStream fis = new FileInputStream(playArchive);<br>         FileInputStream fis2 = new FileInputStream(placesArchive);<br>         ObjectInputStream ois = new ObjectInputStream(fis);<br>         ObjectInputStream ois2 = new ObjectInputStream(fis2)) &#123;<br>        player = (Player) ois.readObject();<br>        places = (ArrayList&lt;Place&gt;) ois2.readObject();<br>    &#125; catch (IOException | ClassNotFoundException e) &#123;<br>        e.printStackTrace();<br>    &#125;<br>    ...<br>    <br>&#125;<br></code></pre></td></tr></table></figure>
<hr>
<h2 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h2><p><em>游戏数据需要存取和读取可以通过数据库</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">public void connectSqlite(String <span class="hljs-built_in">command</span>) &#123;     //连接SQLite 读取/更新<br><br>    try &#123;<br>        //加载驱动（反射）<br>        Class.forName(<span class="hljs-string">&quot;org.sqlite.JDBC&quot;</span>);   <br><br>&#125;    &#125; catch (ClassNotFoundException e) &#123;<br>        e.printStackTrace();<br>    &#125;<br>    try (Connection connection = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:sqlite:rank.db&quot;</span>)) &#123;  //数据库文件名称<br>        //如果rank表不存在则创建<br>        PreparedStatement preparedStatement = connection.prepareStatement(<span class="hljs-string">&quot;create table if not exists rank(name varchar(10), level int, kill int, exp int, creatTime varchar(20))&quot;</span>);<br>        preparedStatement.execute();<br>        switch (<span class="hljs-built_in">command</span>) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;save&quot;</span>:<br>                //预编译Statement<br>                String sql = <span class="hljs-string">&quot;insert into rank values(?, ?, ?, ?, ?)&quot;</span>;<br>                preparedStatement = connection.prepareStatement(sql);<br>                preparedStatement.setString(1, player.getName());<br>                preparedStatement.setInt(2, player.getLevel());<br>                preparedStatement.setInt(3, player.getKill());<br>                preparedStatement.setInt(4, player.getExp());<br>                preparedStatement.setString(5, player.getDATE());<br>                preparedStatement.execute();<br>                <span class="hljs-built_in">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;load&quot;</span>:<br>                //查询语句，按level排序，desc：降序，asc：升序<br>                sql = <span class="hljs-string">&quot;select * from rank order by level desc&quot;</span>;<br>                preparedStatement = connection.prepareStatement(sql);<br>                ResultSet resultSet = preparedStatement.executeQuery();<br>                println(<span class="hljs-string">&quot;姓名       等级    杀敌     经验        创建时间&quot;</span>);<br>                <span class="hljs-keyword">while</span> (resultSet.next()) &#123;<br>                    println(String.format(<span class="hljs-string">&quot;%s    %d     %d      %d       %s&quot;</span>,<br>                            resultSet.getString(1), resultSet.getInt(2), resultSet.getInt(3),<br>                            resultSet.getInt(4), resultSet.getString(5)));<br>                &#125;<br>                <span class="hljs-built_in">break</span>;<br>        &#125;<br>    &#125; catch (SQLException throwables) &#123;<br>        throwables.printStackTrace();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<hr>
<h2 id="文件IO"><a href="#文件IO" class="headerlink" title="文件IO"></a>文件IO</h2><p><em>用字符流加缓存流以字符形式读取文件</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">private void printImage(File file) &#123;<br>    //创建文件字符流,在此基础上创建缓存流，一次性将一部分字符读取到内存中，速度较快<br>    try (FileReader fileReader = new FileReader(file);<br>         BufferedReader bufferedReader = new BufferedReader(fileReader)) &#123;<br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>            //用缓存流按行读取<br>            String line = bufferedReader.readLine();  <br>            //读到null即读完<br>            <span class="hljs-keyword">if</span> (null == line) &#123;<br>                <span class="hljs-built_in">break</span>;<br>            &#125;<br>            println(line);<br>        &#125;<br>    &#125; catch (Exception e) &#123;<br>        e.printStackTrace();<br>    &#125;<br>&#125;<br>```   <br><br>*用Scanner读取txt文件*<br><br>```bash<br>private boolean <span class="hljs-function"><span class="hljs-title">loadGame</span></span>() &#123;<br>    <br>    ...<br>    <br>    Scanner scanner = new Scanner(new File(GAME_FILE));   //根据文件路径创建Scanner对象<br>    loadPlaces(scanner);    //同一个Scanner对象会按顺序读取文件，光标依次向下移动<br>    loadRoutes(scanner);<br>    loadTreasure(scanner);<br>    <br>    ...<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">    private void loadPlaces(Scanner scanner) &#123;<br>    // 读取地点<br>    int nPlaces = scanner.nextInt();            // 读取下一个int，空格为界限，无法读取有空格的内容<br>    scanner.next();                            //Scanner光标后移一位<br>    <span class="hljs-keyword">for</span> (int i = 0; i &lt; nPlaces; i++) &#123;<br>        int placeIndex = scanner.nextInt();     <br>        int danger = scanner.nextInt();     <br>        int infected = scanner.nextInt();   ;<br>        String placeName = scanner.next();     //读取下一个对象<br>        String placeMessage = scanner.next();      <br>        Place place = new Place(placeName);    <br>        <br>        ...<br>        <br>    &#125;<br>    <br>    ...<br>&#125;<br></code></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><hr><a href="/wk1044481101.github.io/2021/02/05/YouNameIt/">← Prev YouNameIt</a><span style="color: #fe2"> | </span><a href="/wk1044481101.github.io/2021/01/19/PS/">PS Next →</a><hr></div><div id="bottom-btn"><a id="to-index" href="#post-index" title="index">≡</a><a id="to-top" href="#post-title" title="to top">∧</a></div><div id="Valine"></div><script>new Valine({
 el: '#Valine'
 , appId: ''
 , appKey: ''
 , placeholder: '此条评论委托企鹅物流发送'
})</script></div></article><aside><div id="about"><a href="/wk1044481101.github.io/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/"> Dr.SamsarA</a></h1><section id="total"><a id="total-archives" href="/wk1044481101.github.io/archives"><span class="total-title">Archives Total:</span><span class="total-number">15</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">5</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">1</span></div></section></div><div id="aside-block" style="order: 0"><h1>INDEX</h1><div id="post-index"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SamsarA%E2%80%99s-ZORK"><span class="toc-number">1.</span> <span class="toc-text">SamsarA’s ZORK</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#OOP"><span class="toc-number">1.1.</span> <span class="toc-text">OOP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.2.</span> <span class="toc-text">序列化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLite"><span class="toc-number">1.3.</span> <span class="toc-text">SQLite</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6IO"><span class="toc-number">1.4.</span> <span class="toc-text">文件IO</span></a></li></ol></li></ol></div></div><footer><nobr><span class="text-title">©</span><span class="text-content">1998 to 2021</span></nobr><wbr><nobr><span class="text-title">ICP</span><span class="text-content">——SAS——</span></nobr><wbr><wbr><nobr>published with&nbsp;<a target="_blank" rel="noopener" href="http://hexo.io">Hexo&nbsp;</a></nobr><wbr><nobr>Theme&nbsp;<a href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight&nbsp;</a></nobr><wbr><nobr>by&nbsp;<a href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/wk1044481101.github.io/js/arknights.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script></body></html>